<div id="report_detail_modal" class="modal modal-open z-50">
    <div class="modal-box w-11/12 max-w-3xl border-t-4 border-info shadow-2xl relative bg-white">
        
        <button type="button" onclick="closeDetailModal()" class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">‚úï</button>
        
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center border-b border-base-200 pb-4 mb-4 gap-2">
            <div>
                <h3 class="font-bold text-xl text-info flex items-center gap-2">
                    üìÑ ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
                </h3>
                <p class="text-sm text-gray-500 mt-1">
                    ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà <span class="font-bold text-gray-800 text-lg ml-1">{{ report.week_number }}</span>
                </p>
            </div>
            
            <div>
                {% if report.status == 'ACKNOWLEDGED' %}
                    <div class="badge badge-success text-white gap-1 p-3 shadow-sm">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>
                        ‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö‡πÅ‡∏•‡πâ‡∏ß
                    </div>
                {% else %}
                    <div class="badge badge-warning text-white gap-1 p-3 shadow-sm">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                        ‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß / ‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="space-y-4 overflow-y-auto max-h-[60vh] pr-2 custom-scrollbar">
            
            <div>
                <h4 class="font-bold text-gray-700 mb-2 flex items-center gap-2">
                    <span class="badge badge-sm badge-info">1</span> ‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥
                </h4>
                <div class="bg-base-200 p-4 rounded-lg text-gray-700 text-sm leading-relaxed border border-base-300">
                    {{ report.work_summary|linebreaks }}
                </div>
            </div>

            <div>
                <h4 class="font-bold text-gray-700 mb-2 flex items-center gap-2">
                    <span class="badge badge-sm badge-error">2</span> ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö
                </h4>
                <div class="bg-base-200 p-4 rounded-lg text-gray-700 text-sm leading-relaxed border border-base-300">
                    {{ report.problems|default:"-"|linebreaks }}
                </div>
            </div>

            <div>
                <h4 class="font-bold text-gray-700 mb-2 flex items-center gap-2">
                    <span class="badge badge-sm badge-success">3</span> ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ
                </h4>
                <div class="bg-base-200 p-4 rounded-lg text-gray-700 text-sm leading-relaxed border border-base-300">
                    {{ report.knowledge_gained|default:"-"|linebreaks }}
                </div>
            </div>

            <div class="mt-6">
                <h4 class="font-bold text-gray-700 mb-2 flex items-center gap-2">
                    <span class="badge badge-sm badge-warning">4</span> ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏à‡∏≤‡∏Å‡∏û‡∏µ‡πà‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á
                </h4>
                <div class="p-4 rounded-lg text-sm leading-relaxed border border-yellow-200 bg-yellow-50 text-gray-800">
                    {% if report.supervisor_feedback %}
                        <div class="flex gap-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-yellow-500 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z" /></svg>
                            <div>
                                {{ report.supervisor_feedback|linebreaks }}
                            </div>
                        </div>
                    {% else %}
                        <p class="text-gray-400 italic text-center">- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞ -</p>
                    {% endif %}
                </div>
            </div>

        </div>

        <div class="modal-action mt-6 pt-4 border-t border-base-200">
            <button type="button" onclick="closeDetailModal()" class="btn btn-neutral">
                ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á
            </button>
        </div>
    </div>

    <div class="modal-backdrop bg-black/40 fixed inset-0 -z-10" onclick="closeDetailModal()"></div>
</div>

<script>
    function closeDetailModal() {
        // ‡∏•‡πâ‡∏≤‡∏á HTML ‡πÉ‡∏ô Container ‡∏ó‡∏¥‡πâ‡∏á
        const container = document.getElementById('modal_container');
        if (container) {
            container.innerHTML = '';
        }

        // ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏ö Element ‡∏ó‡∏¥‡πâ‡∏á‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á (Fallback)
        const modal = document.getElementById('report_detail_modal');
        if (modal) {
            modal.remove();
        }
    }
</script>